name: Cypress Tests Preparation and Execution
on: [push]

jobs:
  prepare-tests:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      # Add other steps for setting up Node, installing dependencies,
      # cleaning up and generating test files, and committing those files
      # as discussed in the previous setup.

  run-tests-in-parallel:
    needs: prepare-tests
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        container: [1, 2, 3] # Define the number of parallel jobs you want to run
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '16' # Specify your project's Node.js version

      - name: Install dependencies
        run: npm install
        working-directory: cypress

      # Running Cypress tests in parallel
      - name: Run Cypress Tests
        run: npx cypress run --env split=true,SPLIT=${{ matrix.container.length }},SPLIT_INDEX=${{ matrix.container }}
        working-directory: cypress
        env:
        # Define any environment variables required for your Cypress tests
